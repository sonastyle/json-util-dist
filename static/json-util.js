let inputEditor=null,resultEditor=null;
$(document).ready(function(){function x(a){if(typeof a!=="string")throw Error("Input must be a JSON string, not an object");a=a.split("\n");for(var b of a){if(!b.trim()||/^[{}\[\]]+$/.test(b.trim()))continue;if(a=b.match(/^(\s+)\S/))return b=a[1],b.includes("\t")?"tab":b.length}return 0}function q(a){try{$(".selectedMiddleButton").each(function(b){$(this).removeClass("selectedMiddleButton")}),a.length>0&&$("#"+a)&&$("#"+a).addClass("selectedMiddleButton")}catch(b){console.error(`Button selection removal error: ${b}`)}}function I(a){$("#colorModal").remove();
var b=$('\n            <div class="modal fade" id="colorModal" tabindex="-1">\n              <div class="modal-dialog modal-lg modal-dialog-scrollable">\n                <div class="modal-content bg-dark text-white">\n                  <div class="modal-header">\n                    <h5 class="modal-title">Color Preview</h5>\n                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>\n                  </div>\n                  <div class="modal-body" style="font-family: monospace;">\n                    <div id="colorModalContent"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          ');
$("body").append(b);b="";try{b=JSON.stringify(JSON.parse(a),null,2)}catch{b=a}a=b.split("\n");const c=$("#colorModalContent");a.forEach(d=>{const e=$("<div class='d-flex justify-content-between align-items-center mb-1 border-bottom border-secondary'></div>");var f=d.match(/:\s*"([^"]+)"/);f=f&&y.test(f[1])?f[1]:null;d=$("<span></span>").text(d);e.append(d);f&&(d=$("<div></div>").css({width:"14px",height:"14px",border:"1px solid #aaa",borderRadius:"2px",background:f}),e.append(d));c.append(e)});(new bootstrap.Modal(document.getElementById("colorModal"))).show()}
function J(a,b){function c(e){if(e&&typeof e==="object"){if(e.format&&typeof e.format==="string"){const f=e.format;if(!JSONSchemaFaker._formats||!JSONSchemaFaker._formats[f]){d===null&&(d=b(f)?"allow":"block");if(d==="block")throw Error('User cancelled generating schema".');delete e.format}}for(const f in e)c(e[f])}}let d=null;c(a);return a}function K(a){return window.confirm("Unknown format detected in SCHEMA. Continue generating fake data for ALL unknown formats?")}function z(a){if(!a||typeof a!==
"object")return a;for(const b in a){const c=a[b];b==="format"&&["byte","binary","base64","data-url"].includes(c)?delete a[b]:b==="contentEncoding"?delete a[b]:b==="contentMediaType"?delete a[b]:b==="media"?delete a[b]:(b==="examples"&&Array.isArray(c)&&(a[b]=c.filter(d=>typeof d!=="string"||!d.startsWith("data:"))),typeof c==="object"&&z(c))}return a}function L(a){if(a.hasOwnProperty("$schema")){const b=a.$schema;if(b.includes("draft-04"))return"draft-04";if(b.includes("draft-06"))return"draft-06";
if(b.includes("draft-07"))return"draft-07";if(b.includes("2020-12"))return"2020-12"}return"id"in a&&!("$id"in a)?"draft-04":"2020-12"}function M(a){a=L(a);if(a==="draft-04"){a=new window.Ajv({allErrors:!0,schemaId:"id",meta:!0,strict:!1});try{a.addMetaSchema(window.draft04MetaSchema,"http://json-schema.org/draft-04/schema#")}catch(b){console.error(`Error loading draft 04 meta: ${b}`)}return a}return a==="draft-06"||a==="draft-07"?new window.ajv7({allErrors:!0,strict:!1,allowUnionTypes:!0}):new window.ajv2020({allErrors:!0,
strict:!1,allowUnionTypes:!0})}function N(a){if(!a)return"";a.startsWith("#/")&&(a=a.replace(/^#\//,"/"));return a.split("/").map(b=>decodeURIComponent(b)).map(b=>b.replace(/~1/g,"/").replace(/~0/g,"~")).join("/")}function A(a,b,c={}){var d=a.aceEditor;if(d){var e="";c.hasOwnProperty("keyword")&&(kw=c.keyword);c.hasOwnProperty("params")&&(params=c.params,Object.keys(params).length>0&&(e+=` | ${JSON.stringify(c.params)}`));c.hasOwnProperty("message")&&c.message.length>0&&(e=e+" | "+c.message);c=N(b);
b=B(a,c);if(!(b===null||b<0)){--b;c=C(c);c=`<option value="${b+1}">${b+1}: ${c}${e}</option>`;var f=a.container.id;e="";f==="json-input-editor"?(e="inp",$("#inputJsonSchemaVSelect").prepend(c),c=$("#inputJsonSchemaVSelect option").length,$("#inputJsonSchemaV").html(`<span><i class="fas fa-scroll"></i> ${c}</span>`),$("#inputJsonSchemaVContainer").is(":visible")||$("#inputJsonSchemaVContainer").show()):f==="json-result-editor"&&(e="res",$("#resultJsonSchemaVSelect").prepend(c),c=$("#resultJsonSchemaVSelect option").length,
$("#resultJsonSchemaV").html(`<span><i class="fas fa-scroll"></i> ${c}</span>`),$("#resultJsonSchemaVContainer").is(":visible")||$("#resultJsonSchemaVContainer").show());b=new (ace.require("ace/range").Range)(b,0,b,Infinity);d=d.session.addMarker(b,"json-diff-highlight","fullline");a._markers||(a._markers=[]);a._markers.push(d);D.includes(e+"-"+d.toString())||D.push(e+"-"+d.toString())}}}function C(a){return a.split("/").filter(Boolean).map(b=>isNaN(b)?b:`[${b}]`).join(".").replace(/\.\[/g,"[")}function B(a,
b){a=a.getText();a.split("\n");a=function(c){function d(){var f=c[e];if(f.type==="{"){f=c[e].line;e++;for(f={type:"object",start:f,props:{}};c[e].type!=="}";){var h=c[e];e++;e++;const g=d();f.props[h.value.replace(/"/g,"")]=g;c[e].type===","&&e++}f.end=c[e].line;e++;return f}if(f.type==="["){f=c[e].line;e++;for(f={type:"array",start:f,items:[]};c[e].type!=="]";)h=d(),f.items.push(h),c[e].type===","&&e++;f.end=c[e].line;e++;return f}if(f.type==="string"||f.type==="word")return e++,{type:"literal",
start:f.line,value:f.value};throw Error("Unexpected token: "+f.type);}let e=0;return d()}(function(c){function d(k,u){e.push({type:k,value:u,line:f,col:h})}const e=[];let f=0,h=0;for(let k=0;k<c.length;k++){var g=c[k];if(g==="\n"){f++;h=0;continue}if(/\s/.test(g)){h++;continue}if("{}[]:,".includes(g)){d(g,g);h++;continue}if(g==='"'){g='"';k++;for(h++;k<c.length;){const u=c[k];g+=u;h++;if(u==='"'&&g[g.length-2]!=="\\")break;k++}d("string",g);continue}for(g=k;k<c.length&&/[A-Za-z0-9.\-]/.test(c[k]);)k++,
h++;g=c.slice(g,k);k--;d("word",g)}return e}(a));b=b.split("/").slice(1).map(c=>/^\d+$/.test(c)?Number(c):c);return(b=function(c,d){for(const e of d)if(c.type==="object")c=c.props[e];else if(c.type==="array")c=c.items[Number(e)];else return null;return c}(a,b))?b.start+1:null}function E(a,b){var c=a.aceEditor;if(c){var d=B(a,b);if(!(d===null||d<0)){--d;b=C(b);var e=`<option value="${d+1}">${d+1}: ${b}</option>`,f=a.container.id;b="";f==="json-input-editor"?(b="inp",$("#inputJsonDiffsSelect").prepend(e),
e=$("#inputJsonDiffsSelect option").length,$("#inputJsonDiffCount").html(`<span><i class="fas fa-balance-scale-right"></i> ${e}</span>`),$("#inputJsonDiffsContainer").is(":visible")||$("#inputJsonDiffsContainer").show()):f==="json-result-editor"&&(b="res",$("#resultJsonDiffsSelect").prepend(e),e=$("#resultJsonDiffsSelect option").length,$("#resultJsonDiffCount").html(`<span><i class="fas fa-balance-scale-right"></i> ${e}</span>`),$("#resultJsonDiffsContainer").is(":visible")||$("#resultJsonDiffsContainer").show());
d=new (ace.require("ace/range").Range)(d,0,d,Infinity);c=c.session.addMarker(d,"json-diff-highlight","fullline");a._markers||(a._markers=[]);a._markers.push(c);O.push(b+"-"+c.toString())}}}function n(a,b){const c=a.aceEditor;a._markers&&(a._markers.forEach(d=>{c.session.removeMarker(d)}),a._markers=[],a=a.container.id,a==="json-input-editor"?($("#inputJsonSchemaVSelect").empty(),$("#inputJsonSchemaV").text(""),$("#inputJsonSchemaVContainer").hide(),$("#inputJsonDiffsSelect").empty(),$("#inputJsonDiffCount").text(""),
$("#inputJsonDiffsContainer").hide()):a==="json-result-editor"&&($("#resultJsonSchemaVSelect").empty(),$("#resultJsonSchemaV").text(""),$("#resultJsonSchemaVContainer").hide(),$("#resultJsonDiffsSelect").empty(),$("#resultJsonDiffCount").text(""),$("#resultJsonDiffsContainer").hide()))}function P(){let a;try{var b=JSON.parse(inputEditor.getText())}catch(c){alert("Invalid JSON in the INPUT editor");return}try{a=JSON.parse(resultEditor.getText())}catch(c){alert("Invalid JSON in the RESULT editor");
return}b=jsonpatch.compare(b,a);n(inputEditor,"diffs");n(resultEditor,"diffs");b.forEach(c=>{E(inputEditor,c.path);E(resultEditor,c.path)})}hostname=window.location.hostname;pageIdentifier=`${hostname}-pdcfls`;JSON.parse(localStorage.getItem(`${pageIdentifier}-inputHistory`));var l=localStorage.getItem(`${pageIdentifier}-schemaPaneVisStatus`);let r=l?JSON.parse(l):!1,t=0;l="ace/theme/jsoneditor";let p=!0;if(window.acejs&&window.themetextmatejs&&window.thememonokaijs){l="ace/theme/twilight";$("#editorThemeSelector").val("twilight");
try{var m=localStorage.getItem(`${pageIdentifier}-editorTheme`);m!=null&&m!="undefined"&&m!=""&&(l="ace/theme/"+m,$("#editorThemeSelector").val(m))}catch{console.log("save theme not found")}}else $("#editorThemeSelector").val(""),console.error("Error loading Ace or its themes.");inputEditor=new JSONEditor(document.getElementById("json-input-editor"),{mode:"code",modes:["view","code","tree","form"],theme:l});resultEditor=new JSONEditor(document.getElementById("json-result-editor"),{mode:"code",modes:["view",
"code","tree","form"],theme:l});let w=function(){$("#json-result-editor .jsoneditor .jsoneditor-menu").css({"background-color":"#28a745",border:"1px solid #28a745"});$("#json-result-editor .jsoneditor").css({border:"1px solid #28a745"});$(".jsoneditor").css({"border-radius":"3px",border:0});$(".jsoneditor-statusbar").css({"border-radius":"0 0 3px 3px"});$(".jsoneditor-menu").css({"border-radius":"3px 3px 0 0"});$(".jsoneditor-tree").css({"border-radius":"0 0 3px 3px"});$(" #json-input-editor, #json-result-editor").css({"box-shadow":"rgba(128, 128, 128, 0.5) 0px 3px 8px",
"border-radius":"4px",border:0})};w();let F=function(){$("#json-input-editor .jsoneditor .jsoneditor-menu").append('\n                     <div class="right-toolbar" id="input-right-editor-toolbar">\n                        <div class="button-container">\n                            <button type="button" id="input-btn-sample"                 class="right-toolbar-btn" title="Create a Sample JSON">                     <i class="fas fa-vial">                     </i></button>\n                            \x3c!-- <button id="input-btn-history"                         class="right-toolbar-btn" title="View History">                             <i class="fas fa-history">                  </i></button> --\x3e\n                            \x3c!-- <button id="input-btn-history-clear"                   class="right-toolbar-btn" title="Erase History">                            <i class="fas fa-eraser">                   </i></button> --\x3e\n                            \x3c!-- <button type="button" id="input-btn-remove-comment"         class="right-toolbar-btn" title="Remove comments">                          <i class="fas fa-comment-slash">            </i></button> --\x3e\n                            \x3c!-- <button type="button" id="input-btn-remove-single-quotes"   class="right-toolbar-btn" title="Convert single quotes to double quotes">   <i class="fas fa-quote-left">        </i></button> --\x3e\n                            <button type="button" id="input-btn-openfile"               class="right-toolbar-btn" title="Open File">                                <i class="fas fa-folder-open">              </i></button>\n                            <button type="button" id="input-btn-validate"               class="right-toolbar-btn" title="Validate JSON">                            <i class="fas fa-check-circle">             </i></button>\n                            <button type="button" id="input-btn-print"                  class="right-toolbar-btn" title="Print JSON">                               <i class="fas fa-print">                    </i></button>\n                            <button type="button" id="input-btn-delete"                 class="right-toolbar-btn" title="Delete JSON">                              <i class="fas fa-trash">                    </i></button>\n                            <button type="button" id="input-btn-copy"                   class="right-toolbar-btn" title="Copy JSON">                                <i class="fas fa-copy">                     </i></button>\n                            <button type="button" id="input-btn-download"               class="right-toolbar-btn"    title="Download JSON">                         <i class="fas fa-download">                 </i></button>\n                            <button type="button" id="input-btn-expand"                 class="right-toolbar-btn" title="Resize Editor">                            <i class="fas fa-expand">                   </i></button>\n                        </div>\n                    </div>\n                ');
$("#input-btn-sample").click(function(){inputEditor.setText(JSON.stringify({stringValue:"Hello world",numberValue:123.45,integerValue:42,booleanTrue:!0,booleanFalse:!1,nullValue:null,arrayOfStrings:["red","green","blue"],arrayOfNumbers:[1,2.5,3],arrayMixed:["text",99,!0,null,{nested:"object"},[1,2,3]],objectValue:{nestedString:"inside object",nestedNumber:10,nestedBoolean:!1,nestedNull:null},deepNested:{level1:{level2:{level3:{value:"deep"}}}},emptyObject:{},emptyArray:[],specialValues:{largeNumber:999999999999,
negativeNumber:-123,floatPrecision:.123456789,unicodeString:"\u3053\u3093\u306b\u3061\u306f\u4e16\u754c",escapedString:"Line1\nLine2\tTabbed"}},null,2))});$("#input-btn-history").click(function(){try{let a=JSON.parse(localStorage.getItem(`${pageIdentifier}-inputHistory`))||[];a.length===0?alert("No history available."):(inputEditor.setText(a[t]),t+1<a.length?t++:t=0)}catch(a){alert("Error retrieving history: "+a.message)}});$("#input-btn-history-clear").click(function(){confirm("Are you sure you want to clear the history?")&&
(localStorage.setItem(`${pageIdentifier}-inputHistory`,JSON.stringify([])),t=0,alert("History cleared."))});$("#input-btn-remove-comment").click(function(){try{const a=inputEditor.getText();let b=!1,c=!1,d="",e="";for(let f=0;f<a.length;f++){const h=a[f],g=a[f+1];c||h!=='"'||e==="\\"||(b=!b);if(!b){if(!c&&h==="/"&&g==="*"){c="block";f++;continue}if(!c&&h==="/"&&g==="/"){c="line";f++;continue}if(c==="block"&&h==="*"&&g==="/"){c=!1;f++;continue}c==="line"&&h==="\n"&&(c=!1);if(c)continue}d+=h;e=h}inputEditor.setText(d)}catch(a){alert("Error removing comments: "+
a.message)}});$("#input-btn-remove-single-quotes").click(function(){var a=inputEditor.getText();try{JSON.parse(a);return}catch(b){}if(/'([^'\\]*(?:\\.[^'\\]*)*)'/.test(a)){a=a.replace(/'([^'\\]*(?:\\.[^'\\]*)*)'/g,'"$1"');try{JSON.parse(a),inputEditor.updateText(a)}catch(b){}}});$("#input-btn-openfile").click(function(){$("#openFileModal").modal("show")});$("#input-btn-validate").click(function(){try{const a=inputEditor.get();p&&resultEditor.set(a);alert("Valid JSON")}catch(a){alert("Invalid JSON")}});
$("#input-btn-print").click(function(){const a=inputEditor.getText(),b=window.open("","");b.document.write("<pre>"+a+"</pre>");b.document.close();b.print();b.onafterprint=function(){b.close()}});$("#input-btn-delete").click(function(){inputEditor.setText("");p&&resultEditor.setText("")});$("#input-btn-copy").click(function(){const a=inputEditor.getText();navigator.clipboard.writeText(a).then(()=>{$("#input-btn-copy").fadeOut(100,function(){$(this).html('<i class="fas fa-check"></i>').fadeIn(100)});
window.setTimeout(()=>{$("#input-btn-copy").fadeOut(100,function(){$(this).html('<i class="fas fa-copy"></i>').fadeIn(100)})},500)}).catch(b=>{alert("Failed to copy text: "+b)})});$("#input-btn-download").click(function(){if(inputEditor.getText().length===0)alert("No JSON data to download.");else try{const a=inputEditor.get(),b=x(inputEditor.getText()),c=new Blob([JSON.stringify(a,null,b)],{type:"application/json"}),d=URL.createObjectURL(c),e=document.createElement("a");e.href=d;e.download="input.json";
document.body.appendChild(e);e.click();document.body.removeChild(e);URL.revokeObjectURL(d)}catch(a){$("#json-result-editor-container").find(".invalid-json-alert").remove(),$("#json-result-editor-container").append('<div class="alert alert-danger invalid-json-alert mt-2" role="alert">Invalid JSON: '+a.message+"</div>")}});$("#input-btn-expand").click(function(){$("#json-input-editor").toggleClass("editor-expand");inputEditor.resize();$("#json-input-editor").hasClass("editor-expand")?$("#divider").hide():
$("#divider").show();$("#center-text").html("JSON Input Editor")})};m=function(){$("#json-input-editor .jsoneditor .jsoneditor-statusbar").append('<span class="scroll-wrap"><span id="inputStatusBarBlocks">\n                    <span id="inputJsonSize"></span>\n                    <span id="inputFontSizeContainer">\n                        <input id="inputFontSizeRange" type="range" title="Font Size" class="slider"/>\n                        <span id="inputFontSizeDisplay"></span>\n                    </span>\n                    <span id="inputJsonDiffsContainer" class="select-wrapper-diffs" title="JSON Differences">\n                        <span id="inputJsonDiffCount" class="select-wrapper-diffs-count">0</span>\n                        <select id="inputJsonDiffsSelect">\n                        </select>\n                    </span>\n                    <span id="inputJsonSchemaVContainer" class="select-wrapper-diffs" title="Json against Schema validation errors">\n                        <span id="inputJsonSchemaV" class="select-wrapper-diffs-count">0</span>\n                        <select id="inputJsonSchemaVSelect">\n                        </select>\n                    </span>\n\n                </span></span>');
const a=inputEditor.aceEditor.getFontSize();$("#inputFontSizeRange").val(parseInt(a,10));$("#inputFontSizeDisplay").html(`${a}`);$("#inputFontSizeRange").on("input",b=>{b=$("#inputFontSizeRange").val();inputEditor.aceEditor.setFontSize(parseInt(b));$("#inputFontSizeDisplay").html(`${b}px`)});$("#inputJsonDiffsContainer").hide();$("#inputJsonSchemaVContainer").hide();$("#inputJsonDiffsSelect").on("click",function(){const b=parseInt($(this).val());isNaN(b)||b<0||inputEditor.aceEditor.gotoLine(b)});
$("#inputJsonSchemaVSelect").on("click",function(){const b=parseInt($(this).val());isNaN(b)||b<0||inputEditor.aceEditor.gotoLine(b)})};let G=function(){$("#json-result-editor .jsoneditor .jsoneditor-menu").append('\n                    <div class="right-toolbar" id="result-right-editor-toolbar">\n                        <div class="button-container">\n                            <button type="button" id="result-btn-copy-to-input"   class="right-toolbar-btn"    title="Copy to Blue editor">  <i class="fas fa-file-import fa-flip-horizontal"></i> </i></button>\n                            <button type="button" id="result-btn-validate"         class="right-toolbar-btn"   title="Validate JSON">        <i class="fas fa-check-circle">     </i></button>\n                            <button type="button" id="result-btn-print"           class="right-toolbar-btn"    title="Print JSON">           <i class="fas fa-print">            </i></button>\n                            <button type="button" id="result-btn-delete"          class="right-toolbar-btn"    title="Delete JSON">          <i class="fas fa-trash">            </i></button>\n                            <button type="button" id="result-btn-copy"            class="right-toolbar-btn"    title="Copy JSON">            <i class="fas fa-copy">             </i></button>\n                            <button type="button" id="result-btn-download"        class="right-toolbar-btn"    title="Download JSON">        <i class="fas fa-download">         </i></button>\n                            <button type="button" id="result-btn-expand"          class="right-toolbar-btn"    title="Resize Editor">        <i class="fas fa-expand">           </i></button>\n                        </div>\n                    </div>\n                ');
$("#result-btn-copy-to-input").click(function(){const a=resultEditor.getText();inputEditor.setText(a)});$("#result-btn-validate").click(function(){try{resultEditor.get(),alert("Valid JSON in Green editor")}catch(a){alert("Invalid JSON in Green editor")}});$("#result-btn-print").click(function(){const a=resultEditor.getText(),b=window.open("","");b.document.write("<pre>"+a+"</pre>");b.document.close();b.print();b.onafterprint=function(){b.close()}});$("#result-btn-delete").click(function(){resultEditor.setText("")});
$("#result-btn-copy").click(function(){const a=resultEditor.getText();navigator.clipboard.writeText(a).then(()=>{$("#result-btn-copy").fadeOut(100,function(){$(this).html('<i class="fas fa-check"></i>').fadeIn(100)});window.setTimeout(()=>{$("#result-btn-copy").fadeOut(100,function(){$(this).html('<i class="fas fa-copy"></i>').fadeIn(100)})},500)}).catch(b=>{alert("Failed to copy text: "+b)})});$("#result-btn-download").click(function(){if(resultEditor.getText().length===0)alert("No JSON data to download.");
else try{const a=resultEditor.get(),b=x(resultEditor.getText()),c=new Blob([JSON.stringify(a,null,b)],{type:"application/json"}),d=URL.createObjectURL(c),e=document.createElement("a");e.href=d;e.download="result.json";document.body.appendChild(e);e.click();document.body.removeChild(e);URL.revokeObjectURL(d)}catch(a){$("#json-result-editor-container").find(".invalid-json-alert").remove(),$("#json-result-editor-container").append('<div class="alert alert-danger invalid-json-alert mt-2" role="alert">Invalid JSON: '+
a.message+"</div>")}});$("#result-btn-expand").click(function(){$("#json-result-editor").toggleClass("editor-expand");resultEditor.resize();$("#json-result-editor").hasClass("editor-expand")?$("#divider").hide():$("#divider").show()})};l=function(){$("#json-result-editor .jsoneditor .jsoneditor-statusbar").append('<span class="scroll-wrap"><span id="resultStatusBarBlocks">\n                    <span id="resultJsonSize"></span>\n                    <span id="resultFontSizeContainer">\n                        <input id="resultFontSizeRange" type="range" title="Font Size" class="slider"/>\n                        <span id="resultFontSizeDisplay"></span>\n                    </span>\n                    <span id="resultJsonDiffsContainer" class="select-wrapper-diffs" title="JSON Differences">\n                        <span id="resultJsonDiffCount" class="select-wrapper-diffs-count"></span>\n                        <select id="resultJsonDiffsSelect">\n                        </select>\n                    </span>\n                    <span id="resultJsonSchemaVContainer" class="select-wrapper-diffs" title="Json against Schema validation errors">\n                      <span id="resultJsonSchemaV" class="select-wrapper-diffs-count">0</span>\n                      <select id="resultJsonSchemaVSelect"></select>\n                    </span>\n                </span></span>');
const a=resultEditor.aceEditor.getFontSize();$("#resultFontSizeRange").val(parseInt(a,10));$("#resultFontSizeDisplay").html(`${a}`);$("#resultFontSizeRange").on("input",b=>{b=$("#resultFontSizeRange").val();resultEditor.aceEditor.setFontSize(parseInt(b));$("#resultFontSizeDisplay").html(`${b}px`)});$("#resultJsonDiffsContainer").hide();$("#resultJsonSchemaVContainer").hide();$("#resultJsonDiffsSelect").on("click",function(){const b=parseInt($(this).val());isNaN(b)||b<0||resultEditor.aceEditor.gotoLine(b)});
$("#resultJsonSchemaVSelect").on("click",function(){const b=parseInt($(this).val());isNaN(b)||b<0||resultEditor.aceEditor.gotoLine(b)})};$(window).width()>=100&&(F(),m(),G(),l());$("#validate-json-btn").on("click",function(){try{const a=inputEditor.get();(function(b,c="success",d=3E3){const e=document.createElement("div");e.className=`alert alert-${c} alert-dismissible fade show position-fixed top-0 start-50 translate-middle-x mt-3`;e.role="alert";e.style.zIndex="9999";e.innerHTML=`
                            ${b}
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        `;document.body.appendChild(e);setTimeout(()=>{bootstrap.Alert.getOrCreateInstance(e).close()},d)})("\u2705 Data is valid!","success",3E3);resultEditor.set(a)}catch(a){alert("Invalid JSON: "+a.message)}});$("#minify-json-btn").on("click",function(){try{const a=inputEditor.get(),b=JSON.stringify(a);resultEditor.setText(b)}catch(a){alert("Invalid JSON: "+a.message)}});$("#beautify-json-btn").on("click",function(){try{const a=inputEditor.get(),b=JSON.stringify(a,null,4);resultEditor.setText(b)}catch(a){alert("Invalid JSON: "+
a.message)}});$("#beautify-json-dropdown a").on("click",function(a){a.preventDefault();a.stopPropagation();a.stopImmediatePropagation();a=$(this).attr("id");a=a==="beautify-tab"?"\t":parseInt(a.replace("beautify-","").replace("-spaces",""),10);try{const b=inputEditor.get(),c=JSON.stringify(b,null,a);resultEditor.setText(c)}catch(b){alert("Invalid JSON: "+b.message)}});$("#obfuscate-json-btn").click(function(){try{const a=inputEditor.get();function b(d){if(typeof d==="string"||typeof d==="number"||
typeof d==="boolean"||d==null)return btoa(unescape(encodeURIComponent(d)));if(Array.isArray(d))return d.map(b);if(typeof d==="object"&&d!==null){const e={};for(const f in d)e[f]=b(d[f]);return e}return d}const c=b(a);resultEditor.set(c)}catch(a){alert("Invalid JSON: "+a.message)}});$("#deobfuscate-json-btn").click(function(){try{const a=inputEditor.get();function b(d){if(typeof d==="string")try{return decodeURIComponent(escape(atob(d)))}catch{}else{if(Array.isArray(d))return d.map(b);if(typeof d===
"object"&&d!==null){const e={};for(const f in d)e[f]=b(d[f]);return e}}return d}const c=b(a);resultEditor.set(c)}catch(a){alert("Invalid JSON: "+a.message)}});const y=RegExp("^(#(?:[0-9a-fA-F]{3,4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})|rgb\\(\\s*(?:\\d{1,3}%?\\s*,\\s*){2}\\d{1,3}%?\\s*\\)|rgba\\(\\s*(?:\\d{1,3}%?\\s*,\\s*){3}(?:0|1|0?\\.\\d+)\\s*\\)|hsl\\(\\s*\\d{1,3}(?:deg|rad|grad|turn)?\\s*,\\s*\\d{1,3}%\\s*,\\s*\\d{1,3}%\\s*\\)|hsla\\(\\s*\\d{1,3}(?:deg|rad|grad|turn)?\\s*,\\s*\\d{1,3}%\\s*,\\s*\\d{1,3}%\\s*,\\s*(?:0|1|0?\\.\\d+)\\s*\\)|hwb\\(.*\\)|lab\\(.*\\)|lch\\(.*\\)|color\\([^\\)]+\\)|[a-zA-Z]+)$"),
H=(a,b="",c={})=>{for(let d in a){const e=a[d],f=Array.isArray(a)?`${b}[${d}]`:b?`${b}.${d}`:d,h=typeof d==="string"&&d.toLowerCase().includes("color"),g=typeof e==="string"&&y.test(e.trim());if(h||g)c[f]=e;e!==null&&typeof e==="object"&&H(e,f,c)}return c};$("#extract-color-btn").click(()=>{let a=inputEditor.getText(),b={};try{b=JSON.parse(a),res=H(b),resultEditor.set(res)}catch(c){alert(`Invalid JSON in BLUE editor: ${c}`)}});$("#extract-color-preview-btn").click(()=>{let a=resultEditor.getText();
I(a)});$("#editorThemeSelector").on("change",a=>{a.stopPropagation();a.preventDefault();a=$("#editorThemeSelector").val();localStorage.setItem(`${pageIdentifier}-editorTheme`,a);$("#grab-bar-button-container").is(":visible")&&$("#dragbar-btn-sh").click();location.reload()});$("#open-schema-catalog-btn").on("click",a=>{a.preventDefault();$("#right-nav-pane").toggle(200,()=>{r=$("#right-nav-pane").is(":visible")?!0:!1;localStorage.setItem(`${pageIdentifier}-schemaPaneVisStatus`,r)});q("open-schema-catalog-btn")});
$("#right-nav-pane-close-btn").on("click",a=>{a.preventDefault();$("#right-nav-pane").hide(200);r=!1;localStorage.setItem(`${pageIdentifier}-schemaPaneVisStatus`,r)});$("#add-schema-btn").on("click",a=>{a.preventDefault();bootstrap.Modal.getOrCreateInstance($("#udSchemaAddModal")[0]).show()});const Q={baseSchema:{$schema:"https://json-schema.org/draft/2020-12/schema",title:"Generated Schema",type:"object"},getSchemaType:function(a){return Array.isArray(a)?"array":a===null?"null":Number.isInteger(a)?
"integer":typeof a==="number"?"number":typeof a},generate:function(a){var b=this.getSchemaType(a);const c={type:b};b==="object"&&a!==null?(c.properties={},b=Object.keys(a),b.length>0&&(c.required=b,b.forEach(d=>{c.properties[d]=this.generate(a[d])}))):b==="array"&&(a.length>0?(b=a.map(d=>this.generate(d)),b=[...(new Set(b.map(d=>d.type)))],c.items=b.length===1?{type:b[0]}:{type:b}):c.items={});return c},convert:function(a){try{const b=typeof a==="string"?JSON.parse(a):a,c=this.generate(b);return{...this.baseSchema,
...c}}catch(b){return console.error("Conversion Error:",b),{error:"Invalid JSON provided"}}}};$("#generate-schema-btn").on("click",function(){try{const a=inputEditor.get(),b=Q.convert(a);resultEditor.set(b)}catch(a){alert(`Please enter a valid JSON in BLUE editor \n\nError: ${a.message}`)}q("generate-schema-btn")});$("#schema-to-json-btn").on("click",function(){try{let a=resultEditor.get();a&&typeof a==="object"&&"$schema"in a&&delete a.$schema;JSONSchemaFaker.format("byte",()=>"");JSONSchemaFaker.format("binary",
()=>"");JSONSchemaFaker.format("base64",()=>"");san_schema=z(a);JSONSchemaFaker.option({ignoreMissingFormats:!0});const b=J(san_schema,K),c=JSONSchemaFaker.generate(b);inputEditor.set(c)}catch(a){alert(`Please enter valid JSON schema in green editor. \n ${a}`)}q("schema-to-json-btn")});$("#schema-to-json-btn-info").on("click",function(){$("#schemaToJsonInfo").remove();var a=document.documentElement.getAttribute("data-bs-theme")==="dark";a=`
            <div class="modal fade text-white-50" id="schemaToJsonInfo" tabindex="-1" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content ${a?"bg-dark text-white":""}">

                  <div class="modal-header ${a?"bg-dark text-white":""}">
                    <h5 class="modal-title  text-center w-100">JSON \u2190 Schema</h5>
                    <button type="button" class="btn-close ${a?"btn-close-white":""}" data-bs-dismiss="modal"></button>
                  </div>

                  <div class="modal-body">
                    <p class="mb-2">
                      This tool generates a <strong>sample JSON</strong> from the provided schema.
                    </p>
                    <p class="mb-2">
                      It is intended for <strong>exploration and quick prototyping only</strong>.
                    </p>
                    <p class="mb-0">
                      The generated JSON may <strong>not fully support</strong>:
                    </p>
                    <ul class="mb-0">
                      <li><strong>$ref</strong> or external references</li>
                      <li><strong>dependencies</strong> / <strong>dependentSchemas</strong></li>
                      <li>complex <strong>oneOf / anyOf / allOf</strong> structures</li>
                    </ul>
                  </div>

                  <div class="modal-footer ${a?"bg-dark text-white":""}">
                    <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">
                      Close
                    </button>
                  </div>

                </div>
              </div>
            </div>
          `;$("body").append(a);(new bootstrap.Modal(document.getElementById("schemaToJsonInfo"))).show()});let D=[];$("#validate-against-schema-btn").on("click",function(){try{let a=resultEditor.get(),b=inputEditor.get();a&&typeof a==="object"||alert("Invalid schema: must be an object");b&&typeof b==="object"||alert("Blue editor must contain a valid JSON");const c=M(a).compile(a);c(b)?(n(inputEditor,"jsv"),n(resultEditor,"jsv"),alert("JSON is VALID against SCHEMA")):(n(inputEditor,"jsv"),n(resultEditor,
"jsv"),c.errors.forEach(d=>{instanePath=d.instancePath;schemaPath=d.schemaPath;A(inputEditor,instanePath,d);A(resultEditor,schemaPath,d)}),q("validate-against-schema-btn"))}catch(a){alert(`Unable to validate JSON against SCHEMA.\n${a}`)}q("validate-against-schema-btn")});$("#clear-json-schema_validation-btn").on("click",function(){n(inputEditor,"jsv");n(resultEditor,"jsv")});let O=[];$("#compare-json-btn").on("click",function(){P();q("compare-json-btn")});$("#clear-comparision-json-btn").on("click",
function(){n(inputEditor,"diffs");n(resultEditor,"diffs")});$("#dragbar-btn-sh").click(a=>{q("")});$("#linkedButtons").hide();$("#unlinkedButtons").hide();let v=(m=localStorage.getItem(`${pageIdentifier}-unlinkEDitorButton`))?JSON.parse(m):!1;$("#editorLinkToggle").on("pointerdown",function(a){a.stopPropagation();a.preventDefault();this.checked?($("#editorLinkToggle").prop("checked",!1),$("#editorLinkText").text("Editor Unlinked"),p=!1,$("#linkedButtons").hide(0),$("#unlinkedButtons").show(0),v=!0):
($("#editorLinkToggle").prop("checked",!0),$("#editorLinkText").text("Editor Linked"),p=!0,$("#linkedButtons").show(0),$("#unlinkedButtons").hide(0),v=!1);localStorage.setItem(`${pageIdentifier}-unlinkEDitorButton`,v)});v?($("#editorLinkToggle").prop("checked",!1),$("#editorLinkText").text("Editor Unlinked"),p=!1,$("#linkedButtons").hide(),$("#unlinkedButtons").show()):($("#editorLinkToggle").prop("checked",!0),$("#editorLinkText").text("Editor Linked"),p=!0,$("#linkedButtons").show(),$("#unlinkedButtons").hide());
inputEditor.options.onModeChange=function(a,b){console.log("Input editor mode changed from",b,"to",a);w();a=inputEditor.getMode();console.log("Current editor mode:",a);a==="code"&&F()};$("#openFileModalOpenBtn").off("click").on("click",function(){if($("#file-tab").hasClass("active")){var a=document.getElementById("jsonFileInput");if(a.files.length>0){a=a.files[0];const b=new FileReader;b.onload=function(c){try{const d=JSON.parse(c.target.result);inputEditor.set(d);$("#openFileModal").modal("hide")}catch(d){alert("Invalid JSON file.")}};
b.readAsText(a)}else alert("Please select a file.")}else $("#url-tab").hasClass("active")&&((a=$("#jsonUrlInput").val())?fetch(a).then(b=>b.json()).then(b=>{inputEditor.set(b);$("#openFileModal").modal("hide")}).catch(()=>{alert("Failed to fetch or parse JSON from URL.")}):alert("Please enter a URL."))});resultEditor.options.onModeChange=function(a,b){console.log("Result editor mode changed from",b,"to",a);w();a=resultEditor.getMode();console.log("Current editor mode:",a);a==="code"&&G()};m=localStorage.getItem(`${pageIdentifier}-inputEditorData`);
l=localStorage.getItem(`${pageIdentifier}-resultEditorData`);if(inputEditor.aceEditor)inputEditor.aceEditor.session.on("change",function(){p&&resultEditor.set({});var a=inputEditor.getText();localStorage.setItem(`${pageIdentifier}-inputEditorData`,a);try{const b=inputEditor.get();p&&resultEditor.set(b);let c=JSON.parse(localStorage.getItem(`${pageIdentifier}-inputHistory`))||[];a&&!c.includes(a)&&(c.push(a),c.length>10&&c.shift(),localStorage.setItem(`${pageIdentifier}-inputHistory`,JSON.stringify(c)))}catch(b){p&&
resultEditor.set("Invalid JSON: "+b.message)}a=(new TextEncoder).encode(a).length;$("#inputJsonSize").html(`${a} Bytes`)});if(resultEditor.aceEditor)resultEditor.aceEditor.session.on("change",function(){var a=resultEditor.getText();localStorage.setItem(`${pageIdentifier}-resultEditorData`,a);a=(new TextEncoder).encode(a).length;$("#resultJsonSize").html(`${a} Bytes`)});try{inputEditor.setText(m)}catch{inputEditor.setText("")}try{resultEditor.setText(l)}catch{resultEditor.setText("")}$("#pane1").show();
$("#divider").removeClass("d-none");$("#divider").show();$("#pane2").show();$("#left-nav-pane").hide();r?$("#right-nav-pane").show():$("#right-nav-pane").hide()});
